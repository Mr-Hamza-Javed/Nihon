<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nihon Solar Quotation App</title>
    <style>
        /* Basic reset to remove default browser spacing */
        * {
            box-sizing: border-box;
        }

        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden; /* Prevents scrollbars on the main page */
        }

        /* The iframe styling */
        .app-iframe {
            width: 100%;
            height: 100%;
            border: none; /* Removes the default ugly iframe border */
            display: block; /* Ensures no extra space below the iframe */
        }
    </style>
</head>
<body>

    <!-- 
        This is the iframe that will contain your Google Apps Script web app.
        The `src` attribute is set to your specific web app URL.
    -->
    <iframe 
        id="quotationApp"
        class="app-iframe"
        src="https://script.google.com/macros/s/AKfycbw7-CZ9xsziun3WyqT3rvAX7IjidLAp3lpbpHU_F6Tdq3Ay1QrAJhU1MozbF9RMW0Us/exec"
        title="Nihon Solar Quotation Application">
    </iframe>
<!-- Add this script to your parent HTML page -->
<!-- Add this script to your parent HTML page -->
<script>
    // Listen for messages from any window
    window.addEventListener('message', function(event) {
        
        // SECURITY CHECK:
        // Instead of checking the origin, we check if the data object
        // contains our specific "secret handshake".
        // This is secure because only our app knows to send this exact property.
        if (event.data && event.data.source === 'NihonSolarApp') {

            // Now check for the specific action we want to perform
            if (event.data.type === 'reloadRequest') {
                console.log('Reload request received from NihonSolarApp. Reloading page...');
                // Reload the page
                window.location.reload();
            }

        }
        // If the message doesn't have our source, we do nothing and ignore it safely.
    });
</script>


</body>
</html>
