<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nihon Solar Quotation App</title>
    <style>
        /* Basic reset to remove default browser spacing */
        * {
            box-sizing: border-box;
        }

        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden; /* Prevents scrollbars on the main page */
        }

        /* The iframe styling */
        .app-iframe {
            width: 100%;
            height: 100%;
            border: none; /* Removes the default ugly iframe border */
            display: block; /* Ensures no extra space below the iframe */
        }
    </style>
</head>
<body>

    <!-- 
        This is the iframe that will contain your Google Apps Script web app.
        The `src` attribute is set to your specific web app URL.
    -->
    <iframe 
        id="quotationApp"
        class="app-iframe"
        src="https://script.google.com/macros/s/AKfycbw7-CZ9xsziun3WyqT3rvAX7IjidLAp3lpbpHU_F6Tdq3Ay1QrAJhU1MozbF9RMW0Us/exec"
        title="Nihon Solar Quotation Application">
    </iframe>
<!-- Add this script to your parent HTML page -->
<!-- Add this script to your parent HTML page -->
<!-- Add this script to your parent HTML page -->
<script>
    // Listen for messages from any window
    window.addEventListener('message', function(event) {
        
        // First, check if the received data is a string. If not, ignore it.
        if (typeof event.data !== 'string') {
            return;
        }

        let data;
        try {
            // Try to parse the string as JSON. THIS IS THE KEY CHANGE.
            data = JSON.parse(event.data);
        } catch (e) {
            // If it's not valid JSON, it's not from our app. Ignore it.
            return;
        }

        // Now that we have a valid object, check for our "secret handshake"
        if (data && data.source === 'NihonSolarApp') {

            // Check for the specific action
            if (data.type === 'reloadRequest') {
                console.log('SUCCESS: Reload request received from NihonSolarApp. Reloading page...');
                
                // Reload the page
                window.location.reload();
            }
        }
    });
</script>


</body>
</html>
